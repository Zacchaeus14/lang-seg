DeprecationWarning: 'source deactivate' is deprecated. Use 'conda deactivate'.
/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/pytorch_lightning/utilities/distributed.py:69: UserWarning: ModelCheckpoint(save_last=True, save_top_k=None, monitor=None) is a redundant configuration. You can save the last checkpoint with ModelCheckpoint(save_top_k=None, monitor=None).
  warnings.warn(*args, **kwargs)
wandb: WARNING `resume` will be ignored since W&B syncing is set to `offline`. Starting a new run with run id c10cgcjt.
wandb: Tracking run with wandb version 0.12.11
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
Multi-processing is handled by Slurm.
initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Set SLURM handle signals.

  | Name           | Type               | Params
------------------------------------------------------
0 | train_accuracy | Accuracy           | 0     
1 | val_accuracy   | Accuracy           | 0     
2 | net            | LSegNet            | 495 M 
3 | criterion      | SegmentationLosses | 0     
------------------------------------------------------
495 M     Trainable params
0         Non-trainable params
495 M     Total params
1,980.546 Total estimated model params size (MB)
/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/encoding/datasets/vizwiz.py:59: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  mask = mask // 255 # 0, 255 to 0, 1
/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/encoding/datasets/vizwiz.py:59: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  mask = mask // 255 # 0, 255 to 0, 1
/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/encoding/datasets/vizwiz.py:59: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  mask = mask // 255 # 0, 255 to 0, 1
/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/encoding/datasets/vizwiz.py:59: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  mask = mask // 255 # 0, 255 to 0, 1
/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/encoding/datasets/vizwiz.py:59: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  mask = mask // 255 # 0, 255 to 0, 1
/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/encoding/datasets/vizwiz.py:59: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  mask = mask // 255 # 0, 255 to 0, 1
/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/encoding/datasets/vizwiz.py:59: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  mask = mask // 255 # 0, 255 to 0, 1
/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/encoding/datasets/vizwiz.py:59: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  mask = mask // 255 # 0, 255 to 0, 1
/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/encoding/datasets/vizwiz.py:59: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  mask = mask // 255 # 0, 255 to 0, 1
/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/encoding/datasets/vizwiz.py:59: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  mask = mask // 255 # 0, 255 to 0, 1
/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/encoding/datasets/vizwiz.py:59: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  mask = mask // 255 # 0, 255 to 0, 1
/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/encoding/datasets/vizwiz.py:59: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  mask = mask // 255 # 0, 255 to 0, 1
/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/encoding/datasets/vizwiz.py:59: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  mask = mask // 255 # 0, 255 to 0, 1
/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/encoding/datasets/vizwiz.py:59: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  mask = mask // 255 # 0, 255 to 0, 1
/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/encoding/datasets/vizwiz.py:59: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  mask = mask // 255 # 0, 255 to 0, 1
/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/encoding/datasets/vizwiz.py:59: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  mask = mask // 255 # 0, 255 to 0, 1
Traceback (most recent call last):
  File "/gpfsnyu/scratch/yw3642/lang-seg/train_lseg.py", line 7, in <module>
    do_training(args, LSegModule)
  File "/gpfsnyu/scratch/yw3642/lang-seg/utils.py", line 47, in do_training
    trainer.fit(model)
  File "/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 458, in fit
    self._run(model)
  File "/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 756, in _run
    self.dispatch()
  File "/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 797, in dispatch
    self.accelerator.start_training(self)
  File "/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/pytorch_lightning/accelerators/accelerator.py", line 96, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 144, in start_training
    self._results = trainer.run_stage()
  File "/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 807, in run_stage
    return self.run_train()
  File "/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 842, in run_train
    self.run_sanity_check(self.lightning_module)
  File "/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1107, in run_sanity_check
    self.run_evaluation()
  File "/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 962, in run_evaluation
    output = self.evaluation_loop.evaluation_step(batch, batch_idx, dataloader_idx)
  File "/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/pytorch_lightning/trainer/evaluation_loop.py", line 174, in evaluation_step
    output = self.trainer.accelerator.validation_step(args)
  File "/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/pytorch_lightning/accelerators/accelerator.py", line 226, in validation_step
    return self.training_type_plugin.validation_step(*args)
  File "/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/pytorch_lightning/plugins/training_type/ddp.py", line 322, in validation_step
    return self.model(*args, **kwargs)
  File "/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 886, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/pytorch_lightning/overrides/base.py", line 57, in forward
    output = self.module.validation_step(*inputs, **kwargs)
  File "/gpfsnyu/scratch/yw3642/lang-seg/modules/lsegmentation_module.py", line 105, in validation_step
    out = self(img, labelset=['other', question])
  File "/gpfsnyu/home/yw3642/.conda/envs/lseg/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
TypeError: forward() got an unexpected keyword argument 'labelset'
wandb: Waiting for W&B process to finish... (failed 1).
wandb: - 0.000 MB of 0.000 MB uploaded (0.000 MB deduped)wandb: \ 0.000 MB of 0.000 MB uploaded (0.000 MB deduped)wandb:                                                                                
wandb: You can sync this run to the cloud by running:
wandb: wandb sync checkpoints/wandb/offline-run-20220318_001500-c10cgcjt
wandb: Find logs at: checkpoints/wandb/offline-run-20220318_001500-c10cgcjt/logs
